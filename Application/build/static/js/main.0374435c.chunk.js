(this["webpackJsonpmaterial-table-test"]=this["webpackJsonpmaterial-table-test"]||[]).push([[0],{22:function(e,t){e.exports={appId:"36fa94fd-9b8b-47cb-af1c-52ec436b9d59",scopes:["chat.read.all","chat.readwrite.all","group.read.all","group.readwrite.all","user.read.all","user.readwrite.all"]}},244:function(e,t,n){e.exports=n(343)},249:function(e,t,n){},343:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),s=n(16),r=n.n(s),c=(n(249),n(6)),i=n.n(c),l=n(15),u=n(17),g=n(113),f=n(67),d=n(70),b=n(114),p=n(178),h=n.n(p),m=n(90),O=n.n(m),v=n(73),w=(n(334),n(342));function j(e){return w.Client.init({authProvider:function(t){t(null,e.accessToken)}})}function N(e){var t,n;return i.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return t=j(e),a.next=3,i.a.awrap(t.api("/me").get());case 3:return n=a.sent,a.abrupt("return",n);case 5:case"end":return a.stop()}}))}function k(e){var t,n;return i.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return t=j(e),a.next=3,i.a.awrap(t.api("/users").select("businessPhones,displayName,givenName,id,jobTitle,mail,mobilePhone,officeLocation,preferredLanguage,surname,userPrincipalName").get());case 3:return n=a.sent,console.log(n),a.abrupt("return",n);case 6:case"end":return a.stop()}}))}var y=n(205),D=n(22),S=n.n(D),R=n(190),A=n.n(R),x=n(200),U=n.n(x),E=n(191),C=n.n(E),I=n(198),P=n.n(I),T=n(136),F=n.n(T),J=n(135),G=n.n(J),z=n(192),L=n.n(z),B=n(193),q=n.n(B),W=n(195),V=n.n(W),$=n(196),_=n.n($),H=n(197),K=n.n(H),M=n(201),Q=n.n(M),X=n(194),Y=n.n(X),Z=n(199),ee=n.n(Z),te=n(202),ne=n.n(te),ae={Add:Object(a.forwardRef)((function(e,t){return o.a.createElement(A.a,Object.assign({},e,{ref:t}))})),Check:Object(a.forwardRef)((function(e,t){return o.a.createElement(C.a,Object.assign({},e,{ref:t}))})),Clear:Object(a.forwardRef)((function(e,t){return o.a.createElement(G.a,Object.assign({},e,{ref:t}))})),Delete:Object(a.forwardRef)((function(e,t){return o.a.createElement(L.a,Object.assign({},e,{ref:t}))})),DetailPanel:Object(a.forwardRef)((function(e,t){return o.a.createElement(F.a,Object.assign({},e,{ref:t}))})),Edit:Object(a.forwardRef)((function(e,t){return o.a.createElement(q.a,Object.assign({},e,{ref:t}))})),Export:Object(a.forwardRef)((function(e,t){return o.a.createElement(Y.a,Object.assign({},e,{ref:t}))})),Filter:Object(a.forwardRef)((function(e,t){return o.a.createElement(V.a,Object.assign({},e,{ref:t}))})),FirstPage:Object(a.forwardRef)((function(e,t){return o.a.createElement(_.a,Object.assign({},e,{ref:t}))})),LastPage:Object(a.forwardRef)((function(e,t){return o.a.createElement(K.a,Object.assign({},e,{ref:t}))})),NextPage:Object(a.forwardRef)((function(e,t){return o.a.createElement(F.a,Object.assign({},e,{ref:t}))})),PreviousPage:Object(a.forwardRef)((function(e,t){return o.a.createElement(P.a,Object.assign({},e,{ref:t}))})),ResetSearch:Object(a.forwardRef)((function(e,t){return o.a.createElement(G.a,Object.assign({},e,{ref:t}))})),Search:Object(a.forwardRef)((function(e,t){return o.a.createElement(ee.a,Object.assign({},e,{ref:t}))})),SortArrow:Object(a.forwardRef)((function(e,t){return o.a.createElement(U.a,Object.assign({},e,{ref:t}))})),ThirdStateCheck:Object(a.forwardRef)((function(e,t){return o.a.createElement(Q.a,Object.assign({},e,{ref:t}))})),ViewColumn:Object(a.forwardRef)((function(e,t){return o.a.createElement(ne.a,Object.assign({},e,{ref:t}))}))},oe="https://example.azurewebsites.net/api/v1/User",se="?code=********************",re=function(e){function t(e){var n;Object(l.a)(this,t),(n=Object(g.a)(this,Object(f.a)(t).call(this,e))).Notify=function(e,t){S.a.isDebug&&console.log("Notify("+String(e)+", "+String(t)+")");var n=new Date;S.a.isDebug&&(console.log("date"),console.log(n));var a=n.getTime();switch(S.a.isDebug&&(console.log("toastId"),console.log(a)),e){case"info":v.b.info(t,{toastId:a});break;case"success":v.b.success(t,{toastId:a});break;case"warning":v.b.warn(t,{toastId:a});break;case"error":v.b.error(t,{toastId:a});break;default:Object(v.b)(t,{toastId:a})}},S.a.isDebug&&console.log("isDebug"),n.userAgentApplication=new y.a({auth:{clientId:S.a.appId},cache:{cacheLocation:"localStorage",storeAuthStateInCookie:!0}}),S.a.isDebug&&(console.log("this.userAgentApplication"),console.log(n.userAgentApplication));var a=n.userAgentApplication.getAccount();return S.a.isDebug&&(console.log("user"),console.log(a)),n.state={isAuthenticated:null!==a,columns:[{title:"AAD ID",field:"aadid",editable:"onAdd"},{title:"DisplayName",field:"displayName"},{title:"ID",field:"id",editable:"never"},{title:"Role",field:"role"},{title:"Organization ID",field:"organizationid"}],user:{},users:[],dbusers:[],graphusers:[]},S.a.isDebug&&(console.log("this.state"),console.log(n.state)),a?(console.log("if (user)"),n.getUserProfile()):(console.log("if (!user)"),n.login()),n.ReadUsers=n.ReadUsers.bind(Object(d.a)(n)),n.Notify=n.Notify.bind(Object(d.a)(n)),n.OnClickUpdate=n.OnClickUpdate.bind(Object(d.a)(n)),n.OnClickRemove=n.OnClickRemove.bind(Object(d.a)(n)),n.JoinGraphUsers(),n}return Object(b.a)(t,e),Object(u.a)(t,[{key:"ReadUsers",value:function(){S.a.isDebug&&console.log("ReadUsers()")}},{key:"JoinGraphUsers",value:function(){var e,t;return i.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return S.a.isDebug&&console.log("JoinGraphUsers()"),n.prev=1,console.log("JoinGraphUsers"),n.next=5,i.a.awrap(window.msal.acquireTokenSilent({scopes:S.a.scopes}));case 5:return e=n.sent,console.log(e),n.next=9,i.a.awrap(k(e));case 9:t=n.sent,console.log("gotusers"),console.log(t),this.setState({graphusers:t.value}),this.Notify("success","[Graph API]\u8aad\u8fbc\u307f\u304c\u5b8c\u4e86\u3057\u307e\u3057\u305f\u3002"),console.log("gotusers.value"),console.log(t.value),n.next=21;break;case 18:n.prev=18,n.t0=n.catch(1),console.log(String(n.t0));case 21:case"end":return n.stop()}}),null,this,[[1,18]])}},{key:"OnClickUpdate",value:function(e){S.a.isDebug&&console.log("OnClickUpdate("+String(e)+")")}},{key:"OnClickRemove",value:function(e){var t=this;S.a.isDebug&&console.log("OnClickRemove("+String(e)+")"),O.a.delete(oe+"/"+e+se).then((function(e){var n=e.status;S.a.isDebug&&(console.log("status"),console.log(n)),"204"===n.toString()&&t.Notify("success","[FUNCTIONS]\u524a\u9664\u304c\u5b8c\u4e86\u3057\u307e\u3057\u305f\u3002")})).catch((function(e){t.Notify("error","[FUNCTIONS]\u901a\u4fe1\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002"+e)}))}},{key:"login",value:function(){var e;return i.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return S.a.isDebug&&console.log("login()"),t.prev=1,t.next=4,i.a.awrap(this.userAgentApplication.loginPopup({scopes:S.a.scopes,prompt:"select_account"}));case 4:return t.next=6,i.a.awrap(this.getUserProfile());case 6:t.next=12;break;case 8:t.prev=8,t.t0=t.catch(1),e=t.t0.split("|"),this.setState({isAuthenticated:!1,user:{},error:{message:e[1],debug:e[0]}});case 12:case"end":return t.stop()}}),null,this,[[1,8]])}},{key:"logout",value:function(){S.a.isDebug&&console.log("logout()"),this.userAgentApplication.logout()}},{key:"getUserProfile",value:function(){var e,t,n,a;return i.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return S.a.isDebug&&console.log("getUserProfile()"),o.prev=1,o.next=4,i.a.awrap(this.userAgentApplication.acquireTokenSilent({scopes:S.a.scopes}));case 4:if(e=o.sent,console.log("accessToken"),console.log(e),!e){o.next=14;break}return o.next=10,i.a.awrap(N(e));case 10:t=o.sent,console.log("usr"),console.log(t),this.setState({isAuthenticated:!0,user:{displayName:t.displayName,email:t.mail||t.userPrincipalName},error:null});case 14:o.next=23;break;case 16:o.prev=16,o.t0=o.catch(1),console.log("err"),console.log(o.t0),n={},"string"===typeof o.t0?(a=o.t0.split("|"),n=a.length>1?{message:a[1],debug:a[0]}:{message:o.t0}):n={message:o.t0.message,debug:JSON.stringify(o.t0)},this.setState({isAuthenticated:!1,user:null,error:n});case 23:case"end":return o.stop()}}),null,this,[[1,16]])}},{key:"render",value:function(){var e=this;return S.a.isDebug&&console.log("render()"),o.a.createElement("div",null,o.a.createElement(h.a,{icons:ae,title:"material-ui-test",columns:this.state.columns,data:this.state.users,editable:{onRowAdd:function(t){return new Promise((function(n,a){setTimeout((function(){O.a.post(oe+se,t).then((function(a){var o=a.status;if(S.a.isDebug&&(console.log("status"),console.log(o)),"201"===o.toString()){e.Notify("success","[FUNCTIONS]\u8ffd\u52a0\u304c\u5b8c\u4e86\u3057\u307e\u3057\u305f\u3002");var s=e.state.users;S.a.isDebug&&(console.log("data"),console.log(s)),s.push(t),e.setState({data:s},(function(){return n()}))}})).catch((function(){console.log("[FUNCTIONS]\u901a\u4fe1\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002")})),n()}),1e3)}))},onRowUpdate:function(t,n){return new Promise((function(a,o){setTimeout((function(){O.a.put(oe+"/"+n.aadid+se,t).then((function(o){var s=o.status;if(S.a.isDebug&&(console.log("status"),console.log(s)),"204"===s.toString()){e.Notify("success","[FUNCTIONS]\u4fdd\u5b58\u304c\u5b8c\u4e86\u3057\u307e\u3057\u305f\u3002");var r=e.state.users;S.a.isDebug&&(console.log("data"),console.log(r));var c=r.indexOf(n);S.a.isDebug&&(console.log("index"),console.log(c)),r[c]=t,e.setState({data:r},(function(){return a()}))}})).catch((function(){e.Notify("error","[FUNCTIONS]\u901a\u4fe1\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002")})),a()}),1e3)}))},onRowDelete:function(t){return new Promise((function(n,a){setTimeout((function(){O.a.delete(oe+"/"+t.aadid+se).then((function(a){var o=a.status;if(S.a.isDebug&&(console.log("status"),console.log(o)),"204"===o.toString()){e.Notify("success","[FUNCTIONS]\u524a\u9664\u304c\u5b8c\u4e86\u3057\u307e\u3057\u305f\u3002");var s=e.state.users;S.a.isDebug&&(console.log("data"),console.log(s));var r=s.indexOf(t);S.a.isDebug&&(console.log("index"),console.log(r)),s.splice(r,1),e.setState({data:s},(function(){return n()}))}})).catch((function(t){e.Notify("error","[FUNCTIONS]\u901a\u4fe1\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002"+t)})),n()}),1e3)}))}},options:{pageSize:10,sorting:!0}}),o.a.createElement(v.a,{hideProgressBar:!0}))}}]),t}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(o.a.createElement(re,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[244,1,2]]]);
//# sourceMappingURL=main.0374435c.chunk.js.map